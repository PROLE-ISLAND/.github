# PROLE-ISLAND 開発ルール

## Issue駆動開発（Claude Code向け）

### 開発開始時の必須手順

**Step 1: 対応可能なIssue確認**
```bash
gh issue list -l "ready-to-develop" --json number,title,labels -q '.[] | "\(.number): \(.title)"'
```

**Step 2: 優先度判断**
- P0 (Critical) → 最優先で即対応
- P1 (High) → 今週中に対応
- P2 (Medium) → スプリント内で対応
- P3 (Low) → バックログ

**Step 3: Issue詳細確認**
```bash
gh issue view {番号}
```

**Step 4: ブランチ作成**
```bash
git checkout -b feature/issue-{番号}-{簡潔な説明}
# 例: git checkout -b feature/issue-42-add-pdf-export
```

**Step 5: 開発完了後のPR作成**
```bash
gh pr create --title "feat: {説明}" --body "closes #{番号}"
```

---

## ラベル体系

| ラベル | 意味 | Claude Codeの対応 |
|--------|------|------------------|
| `ready-to-develop` | 開発可能 | このラベルのIssueを優先的に取得 |
| `in-progress` | 作業中 | 他が作業中なのでスキップ |
| `blocked` | ブロック中 | 依存解決まで待機 |
| `needs-triage` | 要トリアージ | 人間の判断待ち |
| `design-review` | デザインレビュー待ち | Figma承認まで実装待機 |
| `design-approved` | デザイン承認済み | 実装開始OK |
| `no-ui` | UI変更なし | Figma不要、直接開発可能 |

---

## 品質基準 (DoD)

| レベル | カバレッジ | 用途 |
|-------|-----------|------|
| Bronze | 80%以上 | プロトタイプ |
| Silver | 85%以上 | 開発版（推奨） |
| Gold | 95%以上 | 本番品質 |

---

## ブランチ命名規則

```
feature/issue-{番号}-{説明}   # 新機能
bugfix/issue-{番号}-{説明}    # バグ修正
hotfix/issue-{番号}-{説明}    # 緊急修正
```

---

## コミットメッセージ規則

```
feat: 新機能追加
fix: バグ修正
docs: ドキュメント
refactor: リファクタリング
test: テスト追加
ci: CI/CD変更
chore: その他
```

---

## PR規約

- タイトル: `feat:`, `fix:` 等のプレフィックス必須
- 本文: `closes #番号` でIssue紐付け必須
- レビュー: 最低1名の承認必須

---

## Figma-First ワークフロー

**UI/UX変更を含む機能は、Issue作成前にFigmaでデザインを作成する。**

### フロー図

```
┌─────────────────────────────────────────────────────────────────┐
│                    Figma-First 開発フロー                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. デザイン作成（Figma または v0.dev）                          │
│     └─ UIモックアップ・画面遷移を作成                            │
│           │                                                     │
│           ▼                                                     │
│  2. Issue作成（デザインリンク込み）                              │
│     └─ Figmaリンク / v0リンクをIssueに記載                      │
│     └─ ラベル: `design-review` 自動付与                         │
│           │                                                     │
│           ▼                                                     │
│  3. デザインレビュー・承認                                       │
│     └─ 承認後: `design-review` → `design-approved` に変更       │
│           │                                                     │
│           ▼                                                     │
│  4. 実装開始                                                     │
│     └─ `ready-to-develop` ラベル付与                            │
│           │                                                     │
│           ▼                                                     │
│  5. PR作成 → CI → マージ                                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**重要**: デザインリンクのない UI機能 Issue は `design-review` で保留され、実装は開始されません。

### バックエンドのみの機能

UI変更がない場合:
1. Issueテンプレートで「バックエンドのみ」にチェック
2. `no-ui` ラベルを付与
3. Figmaリンクは不要

---

## v0 によるAIデザイン生成

[v0.dev](https://v0.dev) を使用して、UIコンポーネントをAIで生成し、開発を加速する。

### なぜv0か

| 項目 | v0の強み |
|------|----------|
| **技術スタック** | React + Tailwind + shadcn/ui |
| **出力形式** | そのまま使えるTSXコード |
| **品質** | WCAGアクセシビリティ対応がデフォルト |
| **料金** | 無料200クレジット/月、$20/月で無制限 |

### v0プロンプトのガードレール

#### 必須要素（すべてのプロンプトに含める）

```markdown
- shadcn/uiコンポーネント使用
- Tailwind CSS
- ダークモード対応（dark:クラス使用）
- 日本語テキスト
- TypeScript対応
```

#### 禁止パターン

| パターン | 理由 | 代替 |
|---------|------|------|
| ハードコード色 `text-red-500` | ダークモード非対応 | CSS変数 or デザインシステム |
| `px-4 py-2` の直接指定 | 一貫性なし | spacing scale使用 |
| インラインスタイル | 保守性低下 | Tailwindクラス |
| 画像URLの直接埋め込み | 本番で動かない | placeholder or props |

#### v0プロンプトテンプレート

**基本形式:**
```
「{コンポーネント名}を作成。
- shadcn/uiコンポーネント使用
- Tailwind CSS
- ダークモード対応（dark:クラス使用）
- 日本語テキスト
- {具体的な要件}」
```

**パターン別テンプレート → `/v0-templates/` 参照**

### v0コード使用時の必須チェック

1. **ハードコード色の置換**: プロジェクトのデザインシステムに合わせる
2. **型安全性**: Props interfaceを追加
3. **テスト追加**: 単体テストを作成
4. **出典記録**: コンポーネント冒頭にv0 URLをコメントで記載

```typescript
/**
 * ComponentName
 * Generated with v0: https://v0.dev/chat/xxxxx
 * Modified: デザインシステム適用、日本語化
 */
```

---

## デザイン品質チェックリスト

UI機能の実装前に確認:

- [ ] モバイルレスポンシブ対応
- [ ] ダークモード対応
- [ ] アクセシビリティ（コントラスト、フォントサイズ、ARIA）
- [ ] 既存デザインとの整合性
- [ ] ローディング状態
- [ ] エラー状態
- [ ] 空状態（データがない場合）
